# AI_Orchastrator

## Updates
- 2026-02-07: **Image options for multiple choice**: Select, radio, and checkbox fields can show options as **text** or **images** (per-field; no mixing). Data: `FormFieldOption` = `string | { value, imageUrl, altText? }`, `FormField.optionDisplay?: 'text' | 'image'`. Helpers: `frontend/lib/forms/option-utils.ts` (`getOptionValue`, `getOptionLabel`, `getOptionAlt`, `getOptionImageUrl`, `isImageOption`, `getOptionValues`). Admin: Simple form field editor and Card settings panel have “Options display: Text | Images” and, in image mode, rows with Value / Image URL / Alt text. Public: `FieldRenderer` renders image tiles for radio/checkbox/select when `optionDisplay === 'image'`; stored and submitted value remains option value (string/string[]). Validation, logic builder, profile estimation (percentage + multi-dimension), and forms list use option helpers. Plan: `.helper/plan/image-options-for-multiple-choice.md`.
- 2026-02-07: Added admin **Monitor** tab for backend debugging: rate limits (per IP/key), DB table counts, system status. Backend: `GET /general/monitor-stats` (admin/super_admin), `GeneralService.getMonitorStats()` + `CacheService.getKeysByPattern()` for Redis rate-limit keys; frontend: `app/admin/(main)/monitor/page.tsx` (tabs: Overview, Rate limits, Database), sidebar nav “Monitor” (Activity icon), `api.adminAuth.getMonitorStats()` and types in `admin-auth.ts` / `admin-auth.config.ts`.
- 2026-02-07: Implemented Phase 3 Card Form UI Builder: theme presets (form-styling-presets.ts: Minimal, Dark, Light, Brand), contrast check (contrast-utils.ts + WCAG AA warning in Appearance), base font size input (14–24, recommended 16–18) and --form-base-font-size on public form.
- 2026-02-07: Implemented Phase 1 Card Form UI Builder: FormStyling type, FormAppearanceSection, form-styling-utils + CSS vars, CardFormView theme vars. Plan: .helper/plan/card-form-ui-builder-plan.md.
- 2026-02-07: Added plan for Card Form UI Builder (theme/styling layer): `.helper/plan/card-form-ui-builder-plan.md`. Proposal for admin “Appearance” section (fonts, colors, card/button options) and public application via CSS variables; FormTemplate.styling as single source of truth; phased implementation (MVP → more options + preview → presets + a11y).
- 2026-02-07: Form field types: removed leftover "email" and "phone" handling. Admin submission detail page `app/admin/(main)/forms/submissions/[id]/page.tsx` no longer switches on email/phone (they were removed from FormFieldType); backend DTO `backend-api/.../dto/create-form-template.dto.ts` updated to drop email/phone and include statement to match frontend `FormFieldType`.
- 2026-02-07: Card settings panel (node edit dialog) refactored to use parent form: CardSettingsPanel no longer uses its own useForm(); it uses useFormContext<FormTemplateFormValues>() and reads/writes node data at cardSettings.flowchartGraph.nodes[nodeIndex].data. Single form ownership—avoids nested form sync issues. CardFormBuilder passes nodeIndex; handleNodeUpdate removed.
- 2026-02-07: Implemented system-wide frontend refactor (Phase 1 pilot): parent-owned RHF for Profile Estimation; single form in route (new/edit pages), children use `useFormContext` only; `useFieldArray` moved to `ProfileEstimationSetup` (setup-wizard) and passed to CategoryConfig, PercentageConfig, MultiDimensionConfig, RecommendationConfig as props; stable IDs via `lib/utils/stable-id.ts` (`generateStableId`) replacing all `Date.now()` for categories, dimensions, recommendations, schema fields; `reset()` on edit page remains only in `loadTemplate()` after API fetch (true external load). Profile Estimation configs: `frontend/components/admin/forms/profile-estimation/`. Form template pages: `frontend/app/admin/(main)/forms/new/page.tsx`, `[id]/edit/page.tsx`.
- 2026-02-06: Avoid reset on same-value updates in `ProfileEstimationSetup` by comparing serialized signatures, preventing input focus loss while typing in category names.
- 2026-02-06: Added design doc for local-first Profile Estimation editing to prevent focus loss while typing.
- 2026-02-06: Added system-wide frontend refactor design doc.
